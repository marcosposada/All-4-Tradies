<?php eval(base64_decode("Y2xhc3MgQml6dGVjaF9BdXNwb3N0X0hlbHBlcl9EYXRhIGV4dGVuZHMgTWFnZV9Db3JlX0hlbHBlcl9BYnN0cmFjdAogICAgewogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBidWlsZEh0dHBRdWVyeSgkcXVlcnkpCiAgICAgICAgewogICAgICAgICAgICAkcXVlcnlfYXJyYXkgPSBhcnJheSgpOwogICAgICAgICAgICBmb3JlYWNoKCRxdWVyeSBhcyAka2V5ID0+ICRrZXlfdmFsdWUpCiAgICAgICAgICAgICAgICAkcXVlcnlfYXJyYXlbXSA9ICRrZXkgLiAnPScgLiB1cmxlbmNvZGUoICRrZXlfdmFsdWUgKTsKICAgICAgICAgICAgcmV0dXJuIGltcGxvZGUoICcmJywgJHF1ZXJ5X2FycmF5ICk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgZnVuY3Rpb24gcGFyc2VYbWwoJHhtbFN0cmluZykKICAgICAgICB7CiAgICAgICAgICAgIGxpYnhtbF91c2VfaW50ZXJuYWxfZXJyb3JzKHRydWUpOwogICAgICAgICAgICAkeG1sT2JqZWN0ID0gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCR4bWxTdHJpbmcpOwogICAgICAgICAgICAkcmVzdWx0ID0gYXJyYXkgKCk7CiAgICAgICAgICAgIGlmICghZW1wdHkoJHhtbE9iamVjdCkpCiAgICAgICAgICAgICAgICAkdGhpcy0+Y29udmVydFhtbE9ialRvQXJyKCR4bWxPYmplY3QsICRyZXN1bHQpOwogICAgICAgICAgICByZXR1cm4gJHJlc3VsdDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBjb252ZXJ0WG1sT2JqVG9BcnIoJG9iaiwgJiRhcnIpCiAgICAgICAgewogICAgICAgICAgICAkY2hpbGRyZW4gPSAkb2JqLT5jaGlsZHJlbigpOwogICAgICAgICAgICAkZXhlY3V0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgZm9yZWFjaCAoJGNoaWxkcmVuIGFzICRlbGVtZW50TmFtZSA9PiAkbm9kZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoaXNfYXJyYXkoJGFycikgJiYgYXJyYXlfa2V5X2V4aXN0cyggJGVsZW1lbnROYW1lICwgJGFyciApICkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihpc19hcnJheSgkYXJyWyRlbGVtZW50TmFtZV0pJiYgYXJyYXlfa2V5X2V4aXN0cyggMCAsJGFyclskZWxlbWVudE5hbWVdICkgKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGkgPSBjb3VudCgkYXJyWyRlbGVtZW50TmFtZV0pOwogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29udmVydFhtbE9ialRvQXJyICgkbm9kZSwgJGFyclskZWxlbWVudE5hbWVdWyRpXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0bXAgPSAkYXJyWyRlbGVtZW50TmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICRhcnJbJGVsZW1lbnROYW1lXSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRhcnJbJGVsZW1lbnROYW1lXVswXSA9ICR0bXA7CiAgICAgICAgICAgICAgICAgICAgICAgICRpID0gY291bnQoJGFyclskZWxlbWVudE5hbWVdKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNvbnZlcnRYbWxPYmpUb0Fycigkbm9kZSwgJGFyclskZWxlbWVudE5hbWVdWyRpXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRhcnJbJGVsZW1lbnROYW1lXSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNvbnZlcnRYbWxPYmpUb0Fycigkbm9kZSwgJGFyclskZWxlbWVudE5hbWVdKTsgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRleGVjdXRlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoISRleGVjdXRlZCYmJGNoaWxkcmVuLT5nZXROYW1lKCk9PSIiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkYXJyID0gKFN0cmluZykkb2JqOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiA7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgZnVuY3Rpb24gYXVzUG9zdFZhbGlkYXRpb24oJHVybCwgJGhlYWRlcnMgPSBhcnJheSAoKSwgJGF1dGggPSB0cnVlKSAKICAgICAgICB7CiAgICAgICAgICAgICRhcGlfa2V5ICA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdjYXJyaWVycy9hdXNwb3N0L2F1c3Bvc3RfYXBpX2tleScpOwogICAgICAgICAgICAkY2ggPSBjdXJsX2luaXQoKTsKICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwkdXJsKTsKICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCBmYWxzZSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgKICAgICAgICAgICAgICAgICAgICAnQXV0aC1LZXk6ICcgLiAkYXBpX2tleQogICAgICAgICAgICAgICAgKSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgMSk7CiAgICAgICAgICAgICRjb250ZW50cyA9IGN1cmxfZXhlYyAoJGNoKTsKICAgICAgICAgICAgY3VybF9jbG9zZSAoJGNoKTsKICAgICAgICAgICAgcmV0dXJuICRjb250ZW50czsKICAgICAgICB9CgoKICAgICAgICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tLZXkoJGssJGRvbSwkcyA9ICcnKXsKICAgICAgICAgICAgJGNoID0gY3VybF9pbml0KCk7CiAgICAgICAgICAgICRkb21haW5uYW1lID0gdXJsZW5jb2RlKGltcGxvZGUoJywnLCAkZG9tKSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsIHNwcmludGYoJ2h0dHA6Ly9zdG9yZS5iaXp0ZWNoY29uc3VsdGFuY3kuY29tL2V4dGVuc2lvbi9jaGVja2tleS5waHAnKSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsKICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICdrZXk9Jy51cmxlbmNvZGUoJGspLicmZG9tYWlucz0nLiRkb21haW5uYW1lLicmc2VjPWF1c3RyYWxpYW5wb3N0Jyk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAzMCk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgMCk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7CiAgICAgICAgICAgICRjb250ZW50ID0gY3VybF9leGVjKCRjaCk7CiAgICAgICAgICAgICRyZXMgPSBaZW5kX0pzb246OmRlY29kZSgkY29udGVudCk7CiAgICAgICAgICAgICRtb2R1bGVzdGF0dXMgPSBuZXcgTWFnZV9Db3JlX01vZGVsX0NvbmZpZygpOwogICAgICAgICAgICAkZW5jID0gTWFnZTo6aGVscGVyKCdjb3JlJyk7CiAgICAgICAgICAgIGlmKGVtcHR5KCRyZXMpKXsKICAgICAgICAgICAgICAgICRtb2R1bGVzdGF0dXMtPnNhdmVDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9rZXknLCAiIik7CiAgICAgICAgICAgICAgICAkbW9kdWxlc3RhdHVzLT5zYXZlQ29uZmlnKCdjYXJyaWVycy9hdXNwb3N0L2FjdGl2ZScsIDApOwogICAgICAgICAgICAgICAgJGRhdGEgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnYXVzcG9zdC9hY3RpdmF0aW9uL2RhdGEnKTsKICAgICAgICAgICAgICAgICRncm91cHMgPSBhcnJheSgKICAgICAgICAgICAgICAgICAgICAnYWN0aXZhdGlvbic9PmFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAnZmllbGRzJz0+YXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc9PmFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc9PiRkYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dlYnNpdGVzJz0+YXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhbHVlJz0+KHN0cmluZylNYWdlOjpnZXRTdG9yZUNvbmZpZygnYXVzcG9zdC9hY3RpdmF0aW9uL3dlYnNpdGVzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykKICAgICAgICAgICAgICAgIC0+c2V0U2VjdGlvbignYXVzcG9zdCcpCiAgICAgICAgICAgICAgICAtPnNldEdyb3VwcygkZ3JvdXBzKQogICAgICAgICAgICAgICAgLT5zYXZlKCk7CiAgICAgICAgICAgICAgICBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7CiAgICAgICAgICAgICAgICBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7ICAKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAkZGF0YSA9ICcnOwogICAgICAgICAgICAkd2ViID0gJyc7ICAKICAgICAgICAgICAgJGVuID0gJyc7ICAgICAKICAgICAgICAgICAgJHdlYnNpdGVfY29kZSA9IE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCktPmdldFBhcmFtKCd3ZWJzaXRlJyk7ICAgICAgCiAgICAgICAgICAgICR3ZWJzaXRlID0gTWFnZTo6Z2V0TW9kZWwoJ2NvcmUvd2Vic2l0ZScpLT5sb2FkKCR3ZWJzaXRlX2NvZGUsICdjb2RlJyk7ICAgCiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXNbJ2RvbSddKSAmJiBpc3NldCgkcmVzWydzdWMnXSkgKXsKICAgICAgICAgICAgICAgICRkYXRhID0gJGVuYy0+ZW5jcnlwdChiYXNlNjRfZW5jb2RlKFplbmRfSnNvbjo6ZW5jb2RlKCRyZXMpKSk7CiAgICAgICAgICAgICAgICBpZiAoISRzKQogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAkcGFyYW1zID0gIE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCktPmdldFBhcmFtKCdncm91cHMnKTsKICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkcGFyYW1zWydhY3RpdmF0aW9uJ11bJ2ZpZWxkcyddWyd3ZWJzaXRlcyddWyd2YWx1ZSddKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICRzID0gJHBhcmFtc1snYWN0aXZhdGlvbiddWydmaWVsZHMnXVsnd2Vic2l0ZXMnXVsndmFsdWUnXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkZW4gPSAkcmVzWydzdWMnXTsKICAgICAgICAgICAgICAgIGlmKGlzc2V0KCRzKSAmJiAkcyAhPSBudWxsKXsKICAgICAgICAgICAgICAgICAgICAkd2ViID0gJGVuYy0+ZW5jcnlwdCgkZGF0YS5pbXBsb2RlKCcsJywgJHMpLiRkYXRhKTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICR3ZWIgPSAkZW5jLT5lbmNyeXB0KCRkYXRhLiRkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKCR3ZWJzaXRlX2NvZGUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJG1vZHVsZXN0YXR1cy0+c2F2ZUNvbmZpZygnYXVzcG9zdC9hY3RpdmF0aW9uL2tleScsICIiLCd3ZWJzaXRlcycsJHdlYnNpdGUtPmdldFdlYnNpdGVJZCgpKTsKICAgICAgICAgICAgICAgICAgICAkbW9kdWxlc3RhdHVzLT5zYXZlQ29uZmlnKCdjYXJyaWVycy9hdXNwb3N0L2FjdGl2ZScsIDAsJ3dlYnNpdGVzJywkd2Vic2l0ZS0+Z2V0V2Vic2l0ZUlkKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAkbW9kdWxlc3RhdHVzLT5zYXZlQ29uZmlnKCdhdXNwb3N0L2FjdGl2YXRpb24va2V5JywgIiIpOwogICAgICAgICAgICAgICAgICAgICRtb2R1bGVzdGF0dXMtPnNhdmVDb25maWcoJ2NhcnJpZXJzL2F1c3Bvc3QvYWN0aXZlJywgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGdyb3VwcyA9IGFycmF5KAogICAgICAgICAgICAgICAgJ2FjdGl2YXRpb24nPT5hcnJheSgKICAgICAgICAgICAgICAgICAgICAnZmllbGRzJz0+YXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJz0+YXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUnPT4kZGF0YQogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAnd2Vic2l0ZXMnPT5hcnJheSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc9PihzdHJpbmcpJHdlYgogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAnZW4nPT5hcnJheSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc9PiRlbgogICAgICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICAgICAgJ2luc3RhbGxlZCc9PmFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhbHVlJz0+MQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApOwogICAgICAgICAgICBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykKICAgICAgICAgICAgLT5zZXRTZWN0aW9uKCdhdXNwb3N0JykKICAgICAgICAgICAgLT5zZXRHcm91cHMoJGdyb3VwcykKICAgICAgICAgICAgLT5zZXRXZWJzaXRlKCR3ZWJzaXRlLT5nZXRDb2RlKCkpCiAgICAgICAgICAgIC0+c2F2ZSgpOwogICAgICAgICAgICBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7CiAgICAgICAgICAgIE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgIAogICAgICAgIH0KICAgICAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0RG9tYWlucygpCiAgICAgICAgewogICAgICAgICAgICAkZG9tYWlucyA9IGFycmF5KCk7CiAgICAgICAgICAgIGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7CiAgICAgICAgICAgICAgICAkdXJsID0gJHdlYnNpdGUtPmdldENvbmZpZygnd2ViL3Vuc2VjdXJlL2Jhc2VfdXJsJyk7CiAgICAgICAgICAgICAgICBpZigkZG9tYWluID0gdHJpbShwcmVnX3JlcGxhY2UoJy9eLio/XFwvXFwvKC4qKT9cXC8vJywgJyQxJywgJHVybCkpKXsKICAgICAgICAgICAgICAgICAgICAkZG9tYWluc1tdID0gJGRvbWFpbjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvc2VjdXJlL2Jhc2VfdXJsJyk7CiAgICAgICAgICAgICAgICBpZigkZG9tYWluID0gdHJpbShwcmVnX3JlcGxhY2UoJy9eLio/XFwvXFwvKC4qKT9cXC8vJywgJyQxJywgJHVybCkpKXsKICAgICAgICAgICAgICAgICAgICAkZG9tYWluc1tdID0gJGRvbWFpbjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYXJyYXlfdW5pcXVlKCRkb21haW5zKTsKICAgICAgICB9CiAgICAgICAgcHVibGljIGZ1bmN0aW9uIGdldERhdGFJbmZvKCkKICAgICAgICB7CiAgICAgICAgICAgICR3ZWJzaXRlSWQgPSBNYWdlOjphcHAoKS0+Z2V0UmVxdWVzdCgpLT5nZXRQYXJhbSgnd2Vic2l0ZScpOwogICAgICAgICAgICAkZGF0YSA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9kYXRhJyk7CiAgICAgICAgICAgIHJldHVybiBaZW5kX0pzb246OmRlY29kZShiYXNlNjRfZGVjb2RlKE1hZ2U6OmhlbHBlcignY29yZScpLT5kZWNyeXB0KCRkYXRhKSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZ1bmN0aW9uIGdldEFsbFdlYnNpdGVzKCl7CgogICAgICAgICAgICBpZighTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9pbnN0YWxsZWQnKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHdlYnNpdGVJZCA9IE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCktPmdldFBhcmFtKCd3ZWJzaXRlJyk7CiAgICAgICAgICAgICRkYXRhID0gTWFnZTo6YXBwKCktPmdldFdlYnNpdGUoJHdlYnNpdGVJZCktPmdldENvbmZpZygnYXVzcG9zdC9hY3RpdmF0aW9uL2RhdGEnKTsKICAgICAgICAgICAgJHdlYiA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi93ZWJzaXRlcycpOwogICAgICAgICAgICAkd2Vic2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJGRhdGEsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkd2ViKSkpOwogICAgICAgICAgICAkd2Vic2l0ZXMgPSBhcnJheV9kaWZmKCR3ZWJzaXRlcywgYXJyYXkoIiIpKTsKICAgICAgICAgICAgcmV0dXJuICR3ZWJzaXRlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBpc0VuYWJsZSgpCiAgICAgICAgewogICAgICAgICAgICAkc3RvcmVJZCA9IE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCktPmdldFBhcmFtKCdzdG9yZScpOwogICAgICAgICAgICAkd2Vic2l0ZUlkID0gIE1hZ2U6OmdldE1vZGVsKCdjb3JlL3N0b3JlJyktPmxvYWQoJHN0b3JlSWQpLT5nZXRXZWJzaXRlSWQoKSAgOyAKICAgICAgICAgICAgJGlzZW5hYmxlZCA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2NhcnJpZXJzL2F1c3Bvc3QvYWN0aXZlJyk7CiAgICAgICAgICAgIGlmKCRpc2VuYWJsZWQpewogICAgICAgICAgICAgICAgaWYoJHdlYnNpdGVJZCl7CiAgICAgICAgICAgICAgICAgICAgJGtleSA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9rZXknKTsKICAgICAgICAgICAgICAgICAgICBpZigka2V5ID09IG51bGwgfHwgJGtleSA9PSAnJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICRlbiA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9lbicpOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkaXNlbmFibGVkICYmICRlbil7cmV0dXJuIHRydWU7fQogICAgICAgICAgICAgICAgICAgICAgICBlbHNleyByZXR1cm4gZmFsc2U7IH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICRlbiA9IE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlKCR3ZWJzaXRlSWQpLT5nZXRDb25maWcoJ2F1c3Bvc3QvYWN0aXZhdGlvbi9lbicpOwogICAgICAgICAgICAgICAgICAgIGlmKCRpc2VuYWJsZWQgJiYgJGVuKXtyZXR1cm4gdHJ1ZTt9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9"));